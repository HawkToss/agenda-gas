<script>

const NOTIFICACION_OK = 1;
const NOTIFICACION_DANGER = 2;
const NOTIFICACION_WARNING = 3;



function crearTablaContactos()
{
    google.script.run
    .withSuccessHandler(crearTablaContactosCorrectamente)
    .withFailureHandler(crearTablaContactosError)
    .obtenerContactos(); //ejecuta la funcion y le retorna datos que van al obj

}

function crearTablaContactosCorrectamente(obj)
        {   //crea tablas de distintos tipos y agrega los datos
            
            let tabla = document.getElementById("tablaContactos")
            if(tabla) tabla.remove();
            
            tabla = document.createElement("table");
            tabla.id = "tablaContactos";
            let tablaHeader = document.createElement("thead");
            let tablaBody = document.createElement("tbody");

            Array.from(obj).forEach((filaActual,i) =>
            {
                let fila = document.createElement("tr");
                filaActual.forEach(celdaActual =>
                {
                    let celda = document.createElement("td");
                    celda.textContent = celdaActual;
                    fila.appendChild(celda);
                });
                if(i == 0)
                {
                    tablaHeader.appendChild(fila); 
                    tabla.appendChild(tablaHeader);
                }
                else
                {
                tablaBody.appendChild(fila);
                }
            });
            //agregamos clases a la cabecera
            tablaHeader.classList.add("table-dark");
            //agregamos el cuerpo a la tabla
            tabla.appendChild(tablaBody);
            //agregamos clases a la tabla
            tabla.classList.add("table","table-striped","border","border-3","border-dark")
            //agregamos tabla a la pagina
            document.getElementById("divContactos").appendChild(tabla);
            
            //mostrar notificacion de ok
            crearNotificacion(NOTIFICACION_OK,"Contactos obtenidos correctamente","Todo en orden");

        }

function crearTablaContactosError()
{
    crearNotificacion(NOTIFICACION_DANGER,"ESCRIBE BIEN EL CODIGO CRACK SOS BELLO","Favor verificar");
}

function crearNotificacion(tipo,mensaje,titulo)
{
    let mensajeNotificacion = document.getElementById("mensajeNotificacion");
    let tituloNotificacion = document.getElementById("tituloNotificacion");
    let elementoNotificacion = document.getElementById("notificacion");
    let iconoNotificacion = document.getElementById("iconoNotificacion");
    let notificacion = bootstrap.Toast.getOrCreateInstance(elementoNotificacion)

    //editar
    mensajeNotificacion.textContent = mensaje;
    tituloNotificacion.textContent = titulo;

    switch(tipo)
    {
        case NOTIFICACION_OK: 
        iconoNotificacion.className = "";
        iconoNotificacion.classList.add("bi","bi-check2-square");
        elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue("--color-verde-oscuro");
        break;

        case NOTIFICACION_DANGER: 
        iconoNotificacion.className = "";
        iconoNotificacion.classList.add("bi","bi-bug");
        elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue("--color-rojo-oscuro");
        break;

        case NOTIFICACION_WARNING: 
        iconoNotificacion.className = "";
        iconoNotificacion.classList.add("bi","bi-exclamation-square");
        elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue("--color-amarillo-oscuro");
        break;
    }
    

    //mostrar
    notificacion.show()


}

</script>